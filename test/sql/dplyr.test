# name: test/sql/dplyr.test
# description: Basic dplyr extension smoke test
# group: [dplyr]

require dplyr

statement ok
CREATE TABLE items(id INTEGER, val INTEGER);

statement ok
INSERT INTO items VALUES (1, 10), (2, 20);

query I
SELECT * FROM dplyr('items %>% select(id) %>% arrange(id)');
----
1
2

# DPLYR keyword (no wrapper) with select
query I
DPLYR 'items %>% select(id) %>% arrange(id)';
----
1
2

# DPLYR keyword with mutate
query III
DPLYR 'items %>% mutate(val2 = val + 1) %>% arrange(id)';
----
1	10	11
2	20	21

# Implicit pipeline (no keyword, no wrapper) with select
query I
items %>% select(id) %>% arrange(id);
----
1
2

# Implicit pipeline with mutate
query III
items %>% mutate(val2 = val + 1) %>% arrange(id);
----
1	10	11
2	20	21
