name: Test Installation Scripts

on:
  push:
    branches: [ main, develop ]
    paths:
      - 'install.sh'
      - 'install.ps1'
      - '.github/workflows/test-install.yml'
  pull_request:
    branches: [ main, develop ]
    paths:
      - 'install.sh'
      - 'install.ps1'
      - '.github/workflows/test-install.yml'

jobs:
  test-unix-install:
    name: Test Unix Installation Script
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest]
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Test script syntax
      run: |
        bash -n install.sh

  test-windows-install:
    name: Test Windows Installation Script
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Test PowerShell syntax
      run: |
        Get-Command -Syntax .\install.ps1

  test-script-security:
    name: Test Script Security
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Install shellcheck
      run: |
        sudo apt-get update
        sudo apt-get install -y shellcheck

    - name: Run shellcheck on install.sh
      run: |
        shellcheck install.sh
